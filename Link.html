<script>
	import shouldInterceptClick from 'click-should-be-intercepted-for-navigation'
	import { createEventDispatcher } from 'svelte'

	const dispatch = createEventDispatcher()
	export let parametersToQuerystring = null

	export let className = ''
	export let style = ''
	export let meta = null

	export let anchor = ''
	export let parameters = {}

	let element = null

	export let currentQuerystring = () => ({ querystring: ``, parameters: {} })
	$: querystring = parametersToQuerystring(parameters)
	$: hash = anchor ? '#' + anchor : ''

	const onClick = event => {
		if (shouldInterceptClick(event)) {
			event.preventDefault()

			dispatch('navigate', {
				querystring,
				parameters,
				meta,
				hash,
			})
		}
	}
</script>

{#if parameters}
	<a
		href="{querystring}{hash}"
		class="{className}"
		style="{style}"
		on:click="{onClick}"
		bind:this={element}
	>
		<slot></slot>
	</a>
{:else}
	<a
		class="{className}"
		style="{style}"
	>
		<slot></slot>
	</a>
{/if}

